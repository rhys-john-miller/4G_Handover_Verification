<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
		      <html>
		    <head>
		    <title>ProVerif: process</title>
		    <link rel="stylesheet" href="cssproverif.css">
									   </head>
									 <body>
									 <H1>Process</H1>
<a name=occ1 class="occ">{1}</a> <span class="keyword">new</span> <span class="name">a1</span>: <span class="type">alg</span>;<br>
<a name=occ2 class="occ">{2}</a> <span class="keyword">new</span> <span class="name">a2</span>: <span class="type">alg</span>;<br>
<a name=occ3 class="occ">{3}</a> <span class="keyword">new</span> <span class="name">keyAKA</span>: <span class="type">key</span>;<br>
<a name=occ4 class="occ">{4}</a> <span class="keyword">new</span> <span class="name">skSE</span>: <span class="type">sskey</span>;<br>
<a name=occ5 class="occ">{5}</a> <span class="keyword">new</span> <span class="name">skTE</span>: <span class="type">sskey</span>;<br>
<a name=occ6 class="occ">{6}</a> <span class="keyword">new</span> <span class="name">skMME</span>: <span class="type">sskey</span>;<br>
<a name=occ7 class="occ">{7}</a> <span class="keyword">let</span> <span class="var">pkSE</span>: <span class="type">spkey</span> = <span class="fun">spk</span>(<span class="name">skSE</span>) <span class="keyword">in</span><br>
<a name=occ8 class="occ">{8}</a> <span class="keyword">let</span> <span class="var">pkTE</span>: <span class="type">spkey</span> = <span class="fun">spk</span>(<span class="name">skTE</span>) <span class="keyword">in</span><br>
<a name=occ9 class="occ">{9}</a> <span class="keyword">let</span> <span class="var">pkMME</span>: <span class="type">spkey</span> = <span class="fun">spk</span>(<span class="name">skMME</span>) <span class="keyword">in</span><br>
<a name=occ10 class="occ">{10}</a> <span class="keyword">new</span> <span class="name">cellidSource</span>: <span class="type">bitstring</span>;<br>
<a name=occ11 class="occ">{11}</a> <span class="keyword">new</span> <span class="name">cellidTarget</span>: <span class="type">bitstring</span>;<br>
<a name=occ12 class="occ">{12}</a> <span class="keyword">let</span> <span class="var">uecaps</span>: <span class="type">caps</span> = <span class="fun">consset</span>(<span class="name">a1</span>,<span class="fun">consset</span>(<span class="name">a2</span>,<span class="fun">emptyset</span>)) <span class="keyword">in</span><br>
<a name=occ13 class="occ">{13}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="fun"></span>(<span class="var">uecaps</span>,<span class="name">cellidSource</span>,<span class="name">cellidTarget</span>));<br>
<a name=occ14 class="occ">{14}</a> <span class="keyword">let</span> <span class="var">kenb</span>: <span class="type">key</span> = <span class="fun">kdf</span>(<span class="name">cellidSource</span>,<span class="name">keyAKA</span>) <span class="keyword">in</span><br>
<a name=occ15 class="occ">{15}</a> <span class="keyword">let</span> <span class="var">nh_1_33</span>: <span class="type">key</span> = <span class="fun">kdf</span>(<span class="var">kenb</span>,<span class="name">keyAKA</span>) <span class="keyword">in</span><br>
<a name=occ16 class="occ">{16}</a> <span class="keyword">let</span> <span class="var">nh_2_34</span>: <span class="type">key</span> = <span class="fun">kdf</span>(<span class="var">nh_1_33</span>,<span class="name">keyAKA</span>) <span class="keyword">in</span><br>
(<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ17 class="occ">{17}</a> <span class="keyword">new</span> <span class="name">radioSignal</span>: <span class="type">bitstring</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ18 class="occ">{18}</a> <span class="keyword">new</span> <span class="name">PCI</span>: <span class="type">bitstring</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ19 class="occ">{19}</a> <span class="keyword">event</span> <span class="fun">UESendsMeasurementReport</span>(<span class="name">radioSignal</span>,<span class="name">PCI</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ20 class="occ">{20}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="fun"></span>(<span class="name">radioSignal</span>,<span class="name">PCI</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ21 class="occ">{21}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">rrcalg</span>: <span class="type">alg</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ22 class="occ">{22}</a> <span class="keyword">event</span> <span class="fun">UEReceivesHOComand</span>(<span class="var">rrcalg</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ23 class="occ">{23}</a> <span class="keyword">if</span> <span class="pred">mem</span>(<span class="var">rrcalg</span>,<span class="var">uecaps</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ24 class="occ">{24}</a> <span class="keyword">let</span> <span class="var">kenbstar</span>: <span class="type">key</span> = <span class="fun">kdf</span>(<span class="name">cellidSource</span>,<span class="var">kenb</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ25 class="occ">{25}</a> <span class="keyword">event</span> <span class="fun">kenbstarUE</span>(<span class="var">kenbstar</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ26 class="occ">{26}</a> <span class="keyword">let</span> <span class="var">macVal</span>: <span class="type">bitstring</span> = <span class="fun">mac</span>(<span class="var">rrcalg</span>,<span class="var">kenbstar</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ27 class="occ">{27}</a> <span class="keyword">let</span> <span class="var">data</span>: <span class="type">bitstring</span> = <span class="fun">senc</span>(<span class="var">rrcalg</span>,<span class="var">macVal</span>,<span class="var">kenbstar</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ28 class="occ">{28}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">data</span>)<br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ29 class="occ">{29}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="fun"></span>(<span class="var">radioSignal_35</span>: <span class="type">bitstring</span>,<span class="var">PCI_36</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ30 class="occ">{30}</a> <span class="keyword">event</span> <span class="fun">SNSendsHORequiredToTE</span>(<span class="name">cellidSource</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ31 class="occ">{31}</a> <span class="keyword">let</span> <span class="var">kenbstar_37</span>: <span class="type">key</span> = <span class="fun">kdf</span>(<span class="name">cellidSource</span>,<span class="var">kenb</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ32 class="occ">{32}</a> <span class="keyword">event</span> <span class="fun">kenbstarSE</span>(<span class="var">kenbstar_37</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ33 class="occ">{33}</a> <span class="keyword">let</span> <span class="var">sigma1</span>: <span class="type">bitstring</span> = <span class="fun">sign</span>(<span class="fun"></span>(<span class="var">kenbstar_37</span>,<span class="var">uecaps</span>),<span class="name">skSE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ34 class="occ">{34}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">sigma1</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ35 class="occ">{35}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">sigma2</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ36 class="occ">{36}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">rrcalg_38</span>: <span class="type">alg</span>,=<span class="name">hndCMD</span>) = <span class="fun">verify</span>(<span class="var">sigma2</span>,<span class="var">pkTE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ37 class="occ">{37}</a> <span class="keyword">let</span> <span class="var">sigma3</span>: <span class="type">bitstring</span> = <span class="fun">sign</span>(<span class="fun"></span>(<span class="var">kenbstar_37</span>,<span class="name">hndCMDACK</span>),<span class="name">skSE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ38 class="occ">{38}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">sigma3</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ39 class="occ">{39}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, =<span class="name">okHandover</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ40 class="occ">{40}</a> <span class="keyword">event</span> <span class="fun">SNReceivesHOCommandFromTE</span>(<span class="var">rrcalg_38</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ41 class="occ">{41}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">rrcalg_38</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ42 class="occ">{42}</a> <span class="keyword">new</span> <span class="name">snTransfer</span>: <span class="type">bitstring</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ43 class="occ">{43}</a> <span class="keyword">event</span> <span class="fun">startTransfer</span>(<span class="name">snTransfer</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ44 class="occ">{44}</a> <span class="keyword">let</span> <span class="var">sigma4</span>: <span class="type">bitstring</span> = <span class="fun">sign</span>(<span class="name">snTransfer</span>,<span class="name">skSE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ45 class="occ">{45}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">sigma4</span>)<br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ46 class="occ">{46}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">sigma1_39</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ47 class="occ">{47}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">kenbstar_40</span>: <span class="type">key</span>,<span class="var">uecaps_41</span>: <span class="type">caps</span>) = <span class="fun">verify</span>(<span class="var">sigma1_39</span>,<span class="var">pkSE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ48 class="occ">{48}</a> <span class="keyword">event</span> <span class="fun">TNReceivesHORequestFromSE</span>(<span class="name">cellidTarget</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ49 class="occ">{49}</a> <span class="keyword">event</span> <span class="fun">kenbstarTE</span>(<span class="var">kenbstar_40</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ50 class="occ">{50}</a> <span class="keyword">let</span> <span class="var">rrcalg_42</span>: alg <span class="keyword">suchthat</span> <span class="pred">mem</span>(<span class="var">rrcalg_42</span>,<span class="var">uecaps_41</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ51 class="occ">{51}</a> <span class="keyword">let</span> <span class="var">sigma2_43</span>: <span class="type">bitstring</span> = <span class="fun">sign</span>(<span class="fun"></span>(<span class="var">rrcalg_42</span>,<span class="name">hndCMD</span>),<span class="name">skTE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ52 class="occ">{52}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">sigma2_43</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ53 class="occ">{53}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">sigma3_44</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ54 class="occ">{54}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">sourceKenbStar</span>: <span class="type">key</span>,=<span class="name">hndCMDACK</span>) = <span class="fun">verify</span>(<span class="var">sigma3_44</span>,<span class="var">pkSE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ55 class="occ">{55}</a> <span class="keyword">if</span> <span class="fun">not</span>((<span class="var">sourceKenbStar</span> <span class="fun">=</span> <span class="var">kenbstar_40</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ56 class="occ">{56}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="name">failMsg</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ57 class="occ">{57}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="name">okHandover</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ58 class="occ">{58}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">sigma4_45</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ59 class="occ">{59}</a> <span class="keyword">let</span> <span class="var">snTransfer_46</span>: <span class="type">bitstring</span> = <span class="fun">verify</span>(<span class="var">sigma4_45</span>,<span class="var">pkSE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ60 class="occ">{60}</a> <span class="keyword">event</span> <span class="fun">startTransfer</span>(<span class="var">snTransfer_46</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ61 class="occ">{61}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">data_47</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ62 class="occ">{62}</a> <span class="keyword">let</span> <span class="var">rrcmac</span>: <span class="type">bitstring</span> = <span class="fun">sdec</span>(<span class="var">rrcalg_42</span>,<span class="var">data_47</span>,<span class="var">kenbstar_40</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ63 class="occ">{63}</a> <span class="keyword">event</span> <span class="fun">endTransferTE</span>(<span class="var">rrcmac</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ64 class="occ">{64}</a> <span class="keyword">if</span> (<span class="var">rrcmac</span> <span class="fun">=</span> <span class="fun">mac</span>(<span class="var">rrcalg_42</span>,<span class="var">kenbstar_40</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ65 class="occ">{65}</a> <span class="keyword">event</span> <span class="fun">terminateSend</span>(<span class="name">PSR</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ66 class="occ">{66}</a> <span class="keyword">let</span> <span class="var">sigma5</span>: <span class="type">bitstring</span> = <span class="fun">sign</span>(<span class="name">PSR</span>,<span class="name">skTE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ67 class="occ">{67}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">sigma5</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ68 class="occ">{68}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">sigma6</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ69 class="occ">{69}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">nh_2_48</span>: <span class="type">key</span>,<span class="var">mmePSR</span>: <span class="type">bitstring</span>) = <span class="fun">verify</span>(<span class="var">sigma6</span>,<span class="var">pkMME</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">0</span><br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ70 class="occ">{70}</a> <span class="keyword">in</span>(<span class="name">pubch</span>, <span class="var">sigma5_49</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ71 class="occ">{71}</a> <span class="keyword">let</span> =<span class="name">PSR</span> = <span class="fun">verify</span>(<span class="var">sigma5_49</span>,<span class="var">pkTE</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ72 class="occ">{72}</a> <span class="keyword">event</span> <span class="fun">terminateAccept</span>(<span class="var">nh_2_34</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ73 class="occ">{73}</a> <span class="keyword">let</span> <span class="var">sigma6_50</span>: <span class="type">bitstring</span> = <span class="fun">sign</span>(<span class="fun"></span>(<span class="var">nh_2_34</span>,<span class="name">PSR</span>),<span class="name">skMME</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ74 class="occ">{74}</a> <span class="keyword">out</span>(<span class="name">pubch</span>, <span class="var">sigma6_50</span>)<br>
)<br>
<br>
</body>
</html>
